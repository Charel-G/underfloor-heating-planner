# Underfloor Heating Planner

**Note:** This project was generated by an AI assistant during an interactive
programming session. It was not written manually by the repository owner.

This repository contains a small HTML5 application for planning underfloor
heating layouts. It supports multiple floors, snapping walls and zones,
distributor rectangles and automatic pipe routing.
The layout resizes with your browser window so the entire planner fits on screen.
Pipes are drawn from each distributor to its zones using an A* search that
explores eight directions. Diagonal steps are straightened into horizontal and
vertical segments so the pipes never run at odd angles or through walls.
After reaching the zone, only the supply line traces a serpentine loop. The
loop now starts from the entry side itself—typically a doorway—and winds back
and forth across the room before returning to the entry to meet the return
line. The loop is explicitly closed at the entry so there are no broken
segments. The return pipe retraces the original route back to the distributor,
so no second loop is drawn inside the zone. The serpentine pattern is clipped to
the actual zone polygon so irregular shapes like triangles do not produce pipes
outside their boundaries.
When several circuits must follow the same corridor from their distributor,
each pair of pipes is offset to run alongside the others instead of sharing the
exact same line.

The planner now chooses entry points near doorways whenever possible and keeps
pipes about 10–15 cm from walls. The serpentine pattern aligns with the longest
wall of each room so the layout looks like a typical underfloor heating
installation. Supply and return routes follow the shortest axis-aligned path
back to the distributor and are drawn with separate offsets for clarity.

## Features

- Multiple floors with add, rename and delete options
- Walls snap to grid, intersections and existing points, and can be dragged or resized
- A circle preview shows when a new wall snaps to an existing point or segment
- A small length box near the cursor displays the current segment length while drawing
- Walls have adjustable thickness (default 0.25 m) and doorways can be dropped onto walls
- Walls and zones can be drawn segment by segment: each click starts the next line from the previous end. Press **Esc** to finish drawing
- Nearby wall endpoints automatically join to remove small gaps
- Adjacent walls blend together so their thickness appears continuous
- Wall corners connect seamlessly when their thick edges touch; use **Fix Wall Joints** if endpoints drift apart
- Rectangular distributors with editable size, name and pipe connections that snap onto the clicked wall surface. Each connection pair uses its own port along the distributor so manual pipes start neatly side by side
- A distributor list for each floor lets you select and delete distributors
- Zones drawn as polygons assigned to a distributor and spacing
- Automatic supply and return routing with serpentine filling that
  conforms to the zone shape
- A **Draw Pipes** tool lets you trace the connection from distributor to zone;
  the automatic loop begins from that entry path
- Entry points are chosen near doorways and pipes maintain a 10–15 cm
  clearance from walls
- Serpentine rows align with the longest wall of each zone
- Pipes respect wall thickness and keep the loop one spacing away from zone edges
- When different circuits share the same corridor, pipes are offset in pairs so
  each supply and return line runs alongside its partner without overlapping
- Zones are processed from the farthest to the distributor first so corridors remain clear
- If a pipe must cross another zone, the affected segment is drawn dashed in purple
- Toolbar buttons highlight when active and a **Center** button recenters the canvas
- Use the mouse wheel to zoom in and out of the canvas
- Keyboard shortcuts provide quick tool access (W wall, D door, X distributor, Z zone, S select, C center, P pan, R generate pipes, M draw pipes)
- Generated pipes remain selectable objects and can be deleted
- **Export** downloads an image and a JSON project file
- **Import** loads a previously exported project
- If no valid path can be found between a distributor and a zone without
  crossing walls, an alert is shown explaining why routing failed

## Usage

Open `index.html` in a modern web browser. A floor list is displayed to the left of the canvas. Use **Add Floor** to create new floors. The **Rename Floor** and **Delete Floor** buttons act on the currently selected floor (you can also rename by double‑clicking a floor name). Click a floor in the list to view it. Related drawing actions are grouped in the toolbar for quicker access and the active tool button is highlighted.
Below the floor list a distributor list shows all manifolds on the current floor. Selecting one highlights it in the plan and the **Delete Distributor** button removes it.
The **Draw Wall** tool creates snapping lines. After placing a segment the next one begins from the previous endpoint, so you can chain walls together with successive clicks. Press **Esc** to finish and start elsewhere. Use **Draw Zone** in the same way; once you click near the starting point the polygon closes and you can enter its parameters. Use **Select/Move** to drag whole lines or their ends and edit their length in the **Line Length** input. Zones and distributors can also be moved with this tool. Double‑click a zone or distributor to change its properties or use the **Edit Distributor** button when a distributor is selected. Use **Delete Selected** (or press the Delete key) to remove the currently selected wall, zone or distributor.
While drawing a wall you can type a length and press **Enter** to size the segment without using the input box. A tooltip near the cursor shows the current segment length in metres.

Walls are drawn with a default thickness of 0.25 m. When a wall is selected, the **Wall Thickness** input allows you to change this value. The **Add Door** tool places a doorway onto a wall; doors snap to the wall’s centre line and can be repositioned with the select tool or resized by double‑clicking them. The **Add Distributor** tool behaves similarly but positions the manifold flush with the side of the wall closest to the click. Each distributor automatically sizes itself to fit all configured connections, and the ports for manual pipes are arranged along one side so new pipe pairs snap neatly to the grid. Use **Draw Pipes** to trace a connection from a distributor to a zone. These paths stay until you click **Generate Pipes**, which creates the serpentine loop starting from the entry point.

The grid is scaled so that 0.5 m corresponds to roughly 1 cm on screen. The drawing area covers over a kilometre in each direction so you can pan freely when laying out large buildings. **The grid pattern now extends indefinitely,** so it never disappears as you pan across the workspace. Pipe spacing is entered in millimetres. Use the **Pan** tool to move the entire floor plan inside the canvas and scroll the mouse wheel to zoom in or out. **Center** snaps the view back to the origin. Click **Generate Pipes** to automatically route supply and return pipes and fill each zone or select **Draw Pipes** to place your own connection paths. Use **Fix Wall Joints** if corners don't connect correctly. **Clear** asks for confirmation before removing all items from the current floor. Generated pipes remain selectable so you can delete them individually. Segments drawn dashed in purple indicate a pipe that had to cross another zone. Use **Export** to download a PNG and JSON project file. Use **Import** to load a saved project.

The interface uses a darker header with lighter panels below it. The floor list and toolbar have subtle backgrounds so the layout looks more modern and readable.

You can simply open `index.html` in your browser or run a small local server
with Python:

```bash
python3 -m http.server 8000
```

Then visit [http://localhost:8000](http://localhost:8000) in your browser.
